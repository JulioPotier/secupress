var SecuPress={swal2Defaults:{confirmButtonText:SecuPressi18nScanner.confirmText,cancelButtonText:SecuPressi18nScanner.cancelText,type:"warning",allowOutsideClick:!0,customClass:"wpmedia-swal2 secupress-swal2"},swal2ConfirmDefaults:{showCancelButton:!0,closeOnConfirm:!1}};SecuPressi18nScanner.step=Number(SecuPressi18nScanner.step),jQuery(document).ready((function(e){var s,n={},t=[];function r(e){wp.a11y&&wp.a11y.speak&&void 0!==e&&e&&wp.a11y.speak(e)}function c(){var s;if(t&&window.Chart&&SecuPressi18nChart){if(e.isEmptyObject(n))if(Chart&&Chart.hasOwnProperty("version")){const s={datasets:[{data:[SecuPressi18nChart.good.value,SecuPressi18nChart.bad.value,SecuPressi18nChart.warning.value],backgroundColor:["#26B3A9","#CB234F","#F7AB13"],borderWidth:0,cutout:78}]};e.each(t,(function(e,t){var r=t.id;n[r]=new Chart(t.getContext("2d"),{type:"doughnut",data:s,options:{plugins:{tooltip:{enabled:!1}}}})}))}else s=[{value:SecuPressi18nChart.good.value,color:"#26B3A9",highlight:"#2BCDC1",label:SecuPressi18nChart.good.text,status:"good"},{value:SecuPressi18nChart.bad.value,color:"#CB234F",highlight:"#F2295E",label:SecuPressi18nChart.bad.text,status:"bad"},{value:SecuPressi18nChart.warning.value,color:"#F7AB13",highlight:"#F1C40F",label:SecuPressi18nChart.warning.text,status:"warning"}],SecuPressi18nChart.notscannedyet.value>0&&s.push({value:SecuPressi18nChart.notscannedyet.value,color:"#5A626F",highlight:"#888888",label:SecuPressi18nChart.notscannedyet.text,status:"notscannedyet"}),e.each(t,(function(e,t){var r=t.id;n[r]=new Chart(t.getContext("2d")).Doughnut(s,{animationEasing:"easeInOutQuart",showTooltips:!1,segmentShowStroke:!1,percentageInnerCutout:93,tooltipEvents:[]})}));else e.each(t,(function(e,s){var t=s.id;n[t].segments[0].value=SecuPressi18nChart.good.value,n[t].segments[1].value=SecuPressi18nChart.bad.value,n[t].segments[2].value=SecuPressi18nChart.warning.value,void 0!==n[t].segments[3]&&(n[t].segments[3].value=SecuPressi18nChart.notscannedyet.value),n[t].update()}));SecuPressi18nChart.notscannedyet.value||e(".secupress-chart-legend .status-notscannedyet").remove()}}function a(s){return s.each((function(){var s=e(this),n=this.nodeName.toLowerCase();"button"===n||"input"===n?s.attr({disabled:"disabled","aria-disabled":"true"}):s.addClass("disabled").attr("aria-disabled","true")})),s}function i(s){return s.each((function(){var s=e(this),n=this.nodeName.toLowerCase();"button"===n||"input"===n?s.removeAttr("disabled aria-disabled"):s.removeClass("disabled").removeAttr("aria-disabled")})),s}function u(e){var s=e.get(0).nodeName.toLowerCase();if("button"===s||"input"===s)return e.prop("disabled");e.hasClass("disabled")}function o(){var s=e(".secupress-button-manual-fixit");s.find(".secupress-icon-shield").addClass("secupress-icon-check").removeClass("secupress-icon-shield"),e(".secupress-mf-content.fixing").removeClass("fixing"),i(s=s.add(".secupress-button-ignoreit"))}function d(s){var n;1===SecuPressi18nScanner.step&&s?window.location.href.match(/(\?|&)step=1($|&)/)?window.location=window.location.href:window.location=window.location.href.replace("&step=0","")+"&step=1":2===SecuPressi18nScanner.step?window.location=window.location.href.replace(/(\?|&)step=2($|&)/,"$1step=3$2"):3===SecuPressi18nScanner.step&&((n=e(".secupress-manual-fix").not(".hide-if-js")).find(".secupress-button-manual-scanit").find(".secupress-icon-shield").addClass("secupress-icon-check").removeClass("secupress-icon-shield"),o(),n.find(".secupress-button-ignoreit").first().trigger("next.secupress"))}function p(s,n){var r;"boolean"!=typeof n&&(n=!1),SecuPressi18nScanner.i18nNonce?(r={action:"secupress-get-scan-counters",_wpnonce:SecuPressi18nScanner.i18nNonce},e.getJSON(ajaxurl,r).done((function(n){var r;e.isPlainObject(n)&&n.success&&n.data&&(n.data.isBulk=s,r=n.data,t&&window.Chart&&(e(".secupress-chart-container .letter").replaceWith(r.letter),e(".secupress-score-text").html(r.text),e(".secupress-scan-infos .secupress-score").html(r.subtext),e("#wp-admin-bar-secupress").find(".letter").text(r.grade),e("#toplevel_page_"+SecuPressi18nScanner.pluginSlug+"_scanners").find(".update-count").text(r.bad).parent().attr("class",(function(e,s){return s.replace(/count-\d+/,"count-"+r.bad)})),SecuPressi18nChart&&(SecuPressi18nChart.good.value=r.good,SecuPressi18nChart.bad.value=r.bad,SecuPressi18nChart.warning.value=r.warning,SecuPressi18nChart.notscannedyet.value=r.notscannedyet,c())))})).always((function(){d(n)}))):d(n)}document.getElementById("status_chart")&&t.push(document.getElementById("status_chart")),document.getElementById("status_chart_mini")&&t.push(document.getElementById("status_chart_mini")),e(".secupress-score").find(".letter").hasClass("lA")&&"ok"!==function(e){for(var s=e+"=",n=document.cookie.split(";"),t=0;t<n.length;t++){for(var r=n[t];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(s))return r.substring(s.length,r.length)}return""}("secupresstweeted")&&e("#tweeterA").slideDown(),e("#tweeterA .secupress-button").on("click.secupress",(function(){var e=new Date,s=e.getTime()+31104e6;e.setTime(s),document.cookie="secupresstweeted=ok; expires="+e.toGMTString()+"; path=/"})),function(e,s,n){n("#secupress-button-scan-speed").on("click",(function(e){n(this).find("span").toggleClass("dashicons-arrow-down dashicons-arrow-up"),n("#secupress-scan-speed").slideToggle(100)})),n("input[name=secupress-scan-speed]").on("click",(function(e){var s={action:"secupress_set_scan_speed",_wpnonce:n("#secupress-button-scan-speed").data("nonce"),value:n("input[name=secupress-scan-speed]:checked").val()};n.getJSON(ajaxurl,s).done((function(e){SecuPressi18nScanner.offset=e.data.val,n("input[name=secupress-scan-speed][value="+e.data.text+"]").prop("checked","checked"),n("#secupress-button-scan-speed").find("span").toggleClass("dashicons-arrow-down dashicons-arrow-up"),n("#secupress-scan-speed").slideToggle(500)}))}))}(window,document,e),function(e,s,n){function t(e,s,r,c){n.getJSON(e).done((function(a){if(!a.success)return r.replaceWith('<span class="secupress-error-notif">'+SecuPressi18nScanner.error+"</span>"),void c.remove();a.data&&(c.text(a.data+"%"),100!==a.data)?t(e,s,r,c):s.closest(".secupress-notice").fadeTo(100,0,(function(){n(this).slideUp(100,(function(){n(this).remove()}))}))})).fail((function(){r.replaceWith('<span class="secupress-error-notif">'+SecuPressi18nScanner.error+"</span>"),c.remove()}))}n(".secupress-centralize-blog-options").on("click.secupress keyup",(function(e){var s,r,c,a;return!("keyup"===e.type&&!secupressIsSpaceOrEnterKey(e))&&(r=(s=n(this)).attr("href").replace("admin-post.php","admin-ajax.php"),c=n('<img src="'+SecuPressi18nScanner.spinnerUrl+'" alt="" class="secupress-spinner" />'),a=n('<span class="secupress-ajax-percent">0%</span>'),!s.hasClass("running")&&(s.addClass("running").parent().append(c).append(a).find(".secupress-error-notif").remove(),e.preventDefault(),void t(r,s,c,a)))}))}(window,document,e),function(e,s,n){var t=n.propHooks.checked;n.propHooks.checked={set:function(e,s,r){var c;return c=undefined===t?e[r]=s:t(e,s,r),n(e).trigger("change.secupress"),c}},n(".secupress-sg-content .secupress-row-check").on("click",(function(e){var s=n(this).closest(".secupress-scans-group"),t=0===s.find(".secupress-row-check").filter(":visible:enabled").not(":checked").length;s.find(".secupress-toggle-check").prop("checked",t)})).on("change.secupress",(function(e){var s,t=n(this);t.is(":visible:enabled")&&(s=n(".secupress-button-autofix"),t.is(":checked")?s.first().hasClass("hidden")&&(s.next().addClass("hidden"),s.removeClass("hidden")):n(".secupress-sg-content .secupress-row-check").filter(":visible:enabled:checked").length||s.first().hasClass("hidden")||(s.addClass("hidden"),s.next().removeClass("hidden")))})).first().trigger("change.secupress"),n(".secupress-sg-header .secupress-toggle-check").on("click.wp-toggle-checkboxes",(function(e){var s=n(this),t=s.closest(".secupress-scans-group"),r=s.prop("checked"),c=e.shiftKey||s.data("wp-toggle");t.children(".secupress-sg-header").find(".secupress-toggle-check").prop("checked",(function(){var e=n(this);return!e.is(":hidden,:disabled")&&(c?!e.prop("checked"):r)})),t.children(".secupress-sg-content").find(".secupress-row-check").prop("checked",(function(){return!c&&r}))}))}(window,document,e),t&&window.Chart&&(e(".secupress-scanners-header").hasClass("secupress-not-scanned-yet")||c()),function(e,s,n){var t=n(".secupress-scan-header-main .secupress-tabs-controls-list a"),r=t.filter('[href="#secupress-scan"]'),c=n(".secupress-scanners-header"),a=n(".secupress-heading").find(".secupress-last-scan-result"),i="secupress-tab-selected";r.on("click.secupress",(function(){c.removeClass(i),a.off("click.secupress")})),t.not('[href="#secupress-scan"]').on("click.secupress",(function(){c.addClass(i),a.on("click.secupress",(function(){r.trigger("click.secupress")}))}))}(window,document,e),window,document,(s=jQuery(".secupress-start-one-click-scan .secupress-button-scan")).css("width",s.outerWidth()+5),function(e,s,n){var t,l={doingScan:{},doingFix:{},delayedFixes:[],total:0};function f(e){var s=e.match(/[&?]test=([^&]+)(?:$|&)/);return!!s&&s[1]}function h(e){return!(!e.success||!n.isPlainObject(e.data))&&!!(e.data.status&&e.data.class&&e.data.message)}function g(){return n.isEmptyObject(l.doingScan)&&n.isEmptyObject(l.doingFix)&&!l.delayedFixes.length}function m(e,s){e.find(".secupress-item-status .secupress-label").text(s)}function v(e){return 1!==SecuPressi18nScanner.step||(m(e,SecuPressi18nScanner.error),e.addClass("status-error")),!1}t=n("#secupress-tests").find(".secupress-item-all").length,l.total=t;var b=-1;function S(e,s,t,r){var c=parseInt(SecuPressi18nScanner.offset);if(-1===b&&(b=parseInt(-c)),b+=c,!e)return v(s);l.doingScan[e]||(l.doingScan[e]=1,s.addClass("scanning").removeClass("status-error"),setTimeout((function(){n.getJSON(t.replace("admin-post.php","admin-ajax.php")).done((function(t){n(".secupress-scanned-current").html(e.replace(/_/g," ")+"<br>"+n(".secupress-item-all").index(s))})).fail((function(){v(s)})).always((function(){delete l.doingScan[e],g()&&n("body").trigger("allScanDone.secupress",[{isBulk:r}])}))}),b))}function x(){var e=l.delayedFixes.shift();n(e).trigger("bulkfix.secupress")}function C(){var e=n(".secupress-sg-content .secupress-row-check").filter(":checked").siblings(".secupress-fixit");(e=function(e){return n.isEmptyObject(l.doingFix)?(e.filter(".delayed-fix").each((function(){l.delayedFixes.push(this)})),e.not(".delayed-fix")):e}(e)).length?e.trigger("bulkfix.secupress"):x()}function w(e){var s;return(s=(e=e.addClass("status-error").find(".secupress-ic-fix-actions")).next(".secupress-response-notice")).length&&secupressNotices.remove(s),s=secupressNotices.create({type:"bad",message:SecuPressi18nScanner.error}),e.after(s),r(SecuPressi18nScanner.error),o(),!1}function y(e){var s,t=n("#secupress-mf-content-"+e),r=t.children("form.secupress-item-content").serializeArray();if(!r)return w(t);(s=t.removeClass("status-error").find(".secupress-response-notice")).length&&secupressNotices.remove(s),t.addClass("fixing").find(".secupress-button-manual-fixit .secupress-icon-check").addClass("secupress-icon-shield").removeClass("secupress-icon-check"),t.find("button .text").text(SecuPressi18nScanner.fixInProgress),n.post(ajaxurl,r,null,"json").done((function(s){!function(e,s){var n;return h(e)?(n=s.children("form.secupress-item-content"),e.data.form_contents=e.data.form_contents?e.data.form_contents:"",e.data.form_contents||n.find(".secupress-button-manual-fixit").remove(),n.children(".secupress-ic-desc").html(e.data.message),n.children(".secupress-ic-fix-actions").html(e.data.form_contents),!0):w(s)}(s,t)?w(t):n("body").trigger("manualFixDone.secupress",[{test:e,data:s.data}])})).fail((function(){w(t)}))}n("body").on("scanDone.secupress",(function(e,s){n("#"+s.test);l.delayedFixes.length&&x()})),n("body").on("allScanDone.secupress",(function(e,s){var t,r=n(".secupress-button-scan").last();r.length&&u(r)?(t={action:"secupress-update-oneclick-scan-date",_wpnonce:r.data("nonce")},n.getJSON(ajaxurl,t).done((function(e){var s,t;n.isPlainObject(e)&&e.success&&e.data&&(s=e.data,(t=n("#secupress-latest").find(".secupress-reports-list")).children(".secupress-empty").remove(),5===t.children("li").length?t.children("li:last").slideUp(250,(function(){n(this).remove(),t.prepend(s).find("li.hidden").slideDown(250)})):t.prepend(s).find("li.hidden").slideDown(250))})).always((function(){i(n(".secupress-button-scan")),p(s.isBulk,!0)}))):p(s.isBulk)})),n("body").on("fixDone.secupress",(function(e,s){var t=n("#"+s.test),r=t.data("scan-url");S(s.test,t,r,!0)})),n("body").on("allFixDone.secupress",(function(e){})),n("body").on("manualFixDone.secupress",(function(e,s){var t=n("#secupress-mf-content-"+s.test),r=t.data("scan-url");S(s.test,t,r,!1)})),n("body").on("bulkscan.secupress",".secupress-scanit",(function(e){var s,t,r;e.preventDefault(),S(r=f(t=(s=n(this)).attr("href")),s.closest(".secupress-item-"+r),t,!0)})),n("body").on("click.secupress scan.secupress keyup",".secupress-button-manual-scanit",(function(e){var s,t,r,c;if("keyup"===e.type&&!secupressIsSpaceOrEnterKey(e))return!1;u(s=n(this))||(e.preventDefault(),r=f(t=s.attr("href")),c=n("#secupress-mf-content-"+r),a(s),function(e,s,t){e&&(s.addClass("scanning").find(".secupress-button-manual-scanit .secupress-icon-check").addClass("secupress-icon-shield").removeClass("secupress-icon-check"),n.getJSON(t.replace("admin-post.php","admin-ajax.php")).done((function(s){h(s)&&n("body").trigger("scanDone.secupress",[{test:e,href:t,isBulk:!1,data:s.data}])})).always((function(){s.removeClass("scanning"),n("body").trigger("allScanDone.secupress",[{isBulk:!1}])})))}(r,c,t))})),n("body").on("click.secupress bulkscan.secupress keyup",".secupress-button-scan",(function(s){var t;return!("keyup"===s.type&&!secupressIsSpaceOrEnterKey(s))&&(4===SecuPressi18nScanner.step?(e.location=SecuPressi18nScanner.firstScanURL,!1):void(u(t=n(this))||(s.preventDefault(),a(n(".secupress-button-scan")),n("#secupress-button-scan-speed").hide(),n(".secupress-scanit").trigger("bulkscan.secupress"),function(e){var s,t=n(".secupress-introduce-first-scan"),a=n(".secupress-scanners-header"),i=e.closest(".secupress-not-scanned-yet").length,u=n(".secupress-progressbar-val"),o=n(".secupress-progress-val-txt");a.addClass("secupress-scanning"),n(".secupress-scanned-total").text(l.total),s=setInterval((function(){var e=Object.keys(l.doingScan).length,d=l.total-e,p=Math.max(d/l.total*100,2);p=Math.round(Math.min(p,100)),u.css("width",p+"%"),o.text(p+" %"),p>=100&&(r(SecuPressi18nScanner.a11y.scanEnded),clearInterval(s),i?t.slideUp(200,(function(){n(".secupress-open-moreinfo").removeClass("secupress-activated"),n("#secupress-more-info").removeClass("secupress-open").hide(),n(".secupress-scan-header-main").css("display","flex").hide().slideDown(200,(function(){n(".secupress-scanners-header.secupress-not-scanned-yet").removeClass("secupress-not-scanned-yet")})),c()})):a.removeClass("secupress-scanning"))}),100)}(t))))})),n("body").on("bulkfix.secupress",".secupress-fixit",(function(e){var s,t,r;e.preventDefault(),function(e,s,t){e&&(l.doingFix[e]||function(e){return e.hasClass("status-bad")&&!e.hasClass("not-fixable")}(s)&&(l.doingFix[e]=1,s.addClass("fixing").removeClass("status-error"),n.getJSON(t.replace("admin-post.php","admin-ajax.php")).done((function(s){delete l.doingFix[e],h(s)&&n("body").trigger("fixDone.secupress",[{test:e,href:t,data:s.data}])})).fail((function(){delete l.doingFix[e]})).always((function(){n.isEmptyObject(l.doingFix)&&!l.delayedFixes.length&&n("body").trigger("allFixDone.secupress")}))))}(r=f(t=(s=n(this)).attr("href")),s.closest(".secupress-item-"+r),t)})),n("body").on("click.secupress bulkfix.secupress keyup",".secupress-button-autofix",(function(e){var s,t;if("keyup"===e.type&&!secupressIsSpaceOrEnterKey(e))return!1;u(n(this))||(e.preventDefault(),a(n(".secupress-button-autofix")),C(),s=n(".secupress-step-content-header, #secupress-tests, .secupress-step-content-footer"),t=n("#secupress-spinner"),s.spHide(),t.spFadeIn().removeClass("hidden"),r(SecuPressi18nScanner.a11y.bulkFixStart),setTimeout(d,18e4))})),n("body").on("submit.secupress manualfix.secupress","form.secupress-item-content",(function(e){var s=n(this),t=s.find(".secupress-button-manual-fixit");e.preventDefault(),u(t)||(a(n(".secupress-button-manual-fixit, .secupress-button-ignoreit")),y(s.parent(".secupress-mf-content").attr("id").replace("secupress-mf-content-","")))})),n("body").on("click.secupress next.secupress keyup",".secupress-button-ignoreit",(function(s){var t,r,c,a;return!("keyup"===s.type&&!secupressIsSpaceOrEnterKey(s))&&(!u(t=n(this))&&((c=(r=n("."+t.attr("data-parent"))).next()).length?(s.preventDefault(),r.addClass("hide-if-js"),c.removeClass("hide-if-js"),a=n(".step3-advanced-text").first().text(),a=Number(a)+1,void n(".step3-advanced-text").text(a)):(e.location=this.href,!1)))})),n(".secupress-item-all.autoscan .secupress-scanit").trigger("bulkscan.secupress"),SecuPressi18nScanner.firstOneClickScan&&g()&&n(".secupress-button-scan").last().trigger("bulkscan.secupress")}(window,document,e)}));
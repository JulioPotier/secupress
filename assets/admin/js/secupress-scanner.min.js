var SecuPress={swal2Defaults:{confirmButtonText:SecuPressi18nScanner.confirmText,cancelButtonText:SecuPressi18nScanner.cancelText,type:"warning",allowOutsideClick:!0,customClass:"wpmedia-swal2 secupress-swal2"},swal2ConfirmDefaults:{showCancelButton:!0,closeOnConfirm:!1}};SecuPressi18nScanner.step=Number(SecuPressi18nScanner.step),jQuery(document).ready(function(r){var n,a,c,t,e,s,i,u,o,d,p={},l=[];function g(e){wp.a11y&&wp.a11y.speak&&void 0!==e&&e&&wp.a11y.speak(e)}function m(){var t;l&&window.Chart&&SecuPressi18nChart&&(r.isEmptyObject(p)?(t=[{value:SecuPressi18nChart.good.value,color:"#26B3A9",highlight:"#2BCDC1",label:SecuPressi18nChart.good.text,status:"good"},{value:SecuPressi18nChart.bad.value,color:"#CB234F",highlight:"#F2295E",label:SecuPressi18nChart.bad.text,status:"bad"},{value:SecuPressi18nChart.warning.value,color:"#F7AB13",highlight:"#F1C40F",label:SecuPressi18nChart.warning.text,status:"warning"}],0<SecuPressi18nChart.notscannedyet.value&&t.push({value:SecuPressi18nChart.notscannedyet.value,color:"#5A626F",highlight:"#888888",label:SecuPressi18nChart.notscannedyet.text,status:"notscannedyet"}),r.each(l,function(e,s){var n=s.id;p[n]=new Chart(s.getContext("2d")).Doughnut(t,{animationEasing:"easeInOutQuart",showTooltips:!0,segmentShowStroke:!1,percentageInnerCutout:93,tooltipEvents:[]})})):r.each(l,function(e,s){s=s.id;p[s].segments[0].value=SecuPressi18nChart.good.value,p[s].segments[1].value=SecuPressi18nChart.bad.value,p[s].segments[2].value=SecuPressi18nChart.warning.value,void 0!==p[s].segments[3]&&(p[s].segments[3].value=SecuPressi18nChart.notscannedyet.value),p[s].update()}),SecuPressi18nChart.notscannedyet.value||r(".secupress-chart-legend .status-notscannedyet").remove())}function v(e){return e.each(function(){var e=r(this),s=this.nodeName.toLowerCase();"button"===s||"input"===s?e.attr({disabled:"disabled","aria-disabled":"true"}):e.addClass("disabled").attr("aria-disabled","true")}),e}function b(e){return e.each(function(){var e=r(this),s=this.nodeName.toLowerCase();"button"===s||"input"===s?e.removeAttr("disabled aria-disabled"):e.removeClass("disabled").removeAttr("aria-disabled")}),e}function S(e){var s=e.get(0).nodeName.toLowerCase();if("button"===s||"input"===s)return e.prop("disabled");e.hasClass("disabled")}function x(){var e=r(".secupress-button-manual-fixit");e.find(".secupress-icon-shield").addClass("secupress-icon-check").removeClass("secupress-icon-shield"),r(".secupress-mf-content.fixing").removeClass("fixing"),b(e=e.add(".secupress-button-ignoreit"))}function w(e){1===SecuPressi18nScanner.step&&e?window.location.href.match(/(\?|&)step=1($|&)/)?window.location=window.location.href:window.location=window.location.href.replace("&step=0","")+"&step=1":2===SecuPressi18nScanner.step?window.location=window.location.href.replace(/(\?|&)step=2($|&)/,"$1step=3$2"):3===SecuPressi18nScanner.step&&((e=r(".secupress-manual-fix").not(".hide-if-js")).find(".secupress-button-manual-scanit").find(".secupress-icon-shield").addClass("secupress-icon-check").removeClass("secupress-icon-shield"),x(),e.find(".secupress-button-ignoreit").first().trigger("next.secupress"))}function y(s,e){var n;"boolean"!=typeof e&&(e=!1),SecuPressi18nScanner.i18nNonce?(n={action:"secupress-get-scan-counters",_wpnonce:SecuPressi18nScanner.i18nNonce},r.getJSON(ajaxurl,n).done(function(e){var n;r.isPlainObject(e)&&e.success&&e.data&&(e.data.isBulk=s,n=e.data,l&&window.Chart&&(r(".secupress-chart-container .letter").replaceWith(n.letter),r(".secupress-score-text").html(n.text),r(".secupress-scan-infos .secupress-score").html(n.subtext),r("#wp-admin-bar-secupress").find(".letter").text(n.grade),r("#toplevel_page_"+SecuPressi18nScanner.pluginSlug+"_scanners").find(".update-count").text(n.bad).parent().attr("class",function(e,s){return s.replace(/count-\d+/,"count-"+n.bad)}),SecuPressi18nChart&&(SecuPressi18nChart.good.value=n.good,SecuPressi18nChart.bad.value=n.bad,SecuPressi18nChart.warning.value=n.warning,SecuPressi18nChart.notscannedyet.value=n.notscannedyet,m())))}).always(function(){w(e)})):w(e)}document.getElementById("status_chart")&&l.push(document.getElementById("status_chart")),document.getElementById("status_chart_mini")&&l.push(document.getElementById("status_chart_mini")),r(".secupress-score").find(".letter").hasClass("lA")&&"ok"!==function(e){for(var s=e+"=",n=document.cookie.split(";"),t=0;t<n.length;t++){for(var r=n[t];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(s))return r.substring(s.length,r.length)}return""}("secupresstweeted")&&r("#tweeterA").slideDown(),r("#tweeterA .secupress-button").on("click.secupress",function(){var e=new Date,s=e.getTime()+31104e6;e.setTime(s),document.cookie="secupresstweeted=ok; expires="+e.toGMTString()+"; path=/",r("#tweeterA").slideUp()}),window,document,(n=r)("#secupress-button-scan-speed").on("click",function(e){n(this).find("span").toggleClass("dashicons-arrow-down dashicons-arrow-up"),n("#secupress-scan-speed").slideToggle(100)}),n("input[name=secupress-scan-speed]").on("click",function(e){var s={action:"secupress_set_scan_speed",_wpnonce:n("#secupress-button-scan-speed").data("nonce"),value:n("input[name=secupress-scan-speed]:checked").val()};n.getJSON(ajaxurl,s).done(function(e){SecuPressi18nScanner.offset=e.data.val,n("input[name=secupress-scan-speed][value="+e.data.text+"]").prop("checked","checked"),n("#secupress-button-scan-speed").find("span").toggleClass("dashicons-arrow-down dashicons-arrow-up"),n("#secupress-scan-speed").slideToggle(500)})}),window,document,(a=r)(".secupress-centralize-blog-options").on("click.secupress keyup",function(e){var s,n,t,r;return!("keyup"===e.type&&!secupressIsSpaceOrEnterKey(e))&&(n=(s=a(this)).attr("href").replace("admin-post.php","admin-ajax.php"),t=a('<img src="'+SecuPressi18nScanner.spinnerUrl+'" alt="" class="secupress-spinner" />'),r=a('<span class="secupress-ajax-percent">0%</span>'),!s.hasClass("running")&&(s.addClass("running").parent().append(t).append(r).find(".secupress-error-notif").remove(),e.preventDefault(),void function s(n,t,r,c){a.getJSON(n).done(function(e){return e.success?void(e.data&&(c.text(e.data+"%"),100!==e.data)?s(n,t,r,c):t.closest(".secupress-notice").fadeTo(100,0,function(){a(this).slideUp(100,function(){a(this).remove()})})):(r.replaceWith('<span class="secupress-error-notif">'+SecuPressi18nScanner.error+"</span>"),void c.remove())}).fail(function(){r.replaceWith('<span class="secupress-error-notif">'+SecuPressi18nScanner.error+"</span>"),c.remove()})}(n,s,t,r)))}),window,document,t=(c=r).propHooks.checked,c.propHooks.checked={set:function(e,s,n){n=void 0===t?e[n]=s:t(e,s,n);return c(e).trigger("change.secupress"),n}},c(".secupress-sg-content .secupress-row-check").on("click",function(e){var s=c(this).closest(".secupress-scans-group"),n=0===s.find(".secupress-row-check").filter(":visible:enabled").not(":checked").length;s.find(".secupress-toggle-check").prop("checked",n)}).on("change.secupress",function(e){var s,n=c(this);n.is(":visible:enabled")&&(s=c(".secupress-button-autofix"),n.is(":checked")?s.first().hasClass("hidden")&&(s.next().addClass("hidden"),s.removeClass("hidden")):c(".secupress-sg-content .secupress-row-check").filter(":visible:enabled:checked").length||s.first().hasClass("hidden")||(s.addClass("hidden"),s.next().removeClass("hidden")))}).first().trigger("change.secupress"),c(".secupress-sg-header .secupress-toggle-check").on("click.wp-toggle-checkboxes",function(e){var s=c(this),n=s.closest(".secupress-scans-group"),t=s.prop("checked"),r=e.shiftKey||s.data("wp-toggle");n.children(".secupress-sg-header").find(".secupress-toggle-check").prop("checked",function(){var e=c(this);return!e.is(":hidden,:disabled")&&(r?!e.prop("checked"):!!t)}),n.children(".secupress-sg-content").find(".secupress-row-check").prop("checked",function(){return!r&&!!t})}),l&&window.Chart&&(r(".secupress-scanners-header").hasClass("secupress-not-scanned-yet")||m()),window,document,d=(e=r)(".secupress-scan-header-main .secupress-tabs-controls-list a"),s=d.filter('[href="#secupress-scan"]'),i=e(".secupress-scanners-header"),u=e(".secupress-heading").find(".secupress-last-scan-result"),o="secupress-tab-selected",s.on("click.secupress",function(){i.removeClass(o),u.off("click.secupress")}),d.not('[href="#secupress-scan"]').on("click.secupress",function(){i.addClass(o),u.on("click.secupress",function(){s.trigger("click.secupress")})}),window,document,(d=jQuery(".secupress-start-one-click-scan .secupress-button-scan")).css("width",d.outerWidth()+5),function(u,o){var e,d={doingScan:{},doingFix:{},delayedFixes:[],total:0};function i(e){e=e.match(/[&?]test=([^&]+)(?:$|&)/);return!!e&&e[1]}function p(e){return e.success&&o.isPlainObject(e.data)&&!!(e.data.status&&e.data.class&&e.data.message)}function c(){return o.isEmptyObject(d.doingScan)&&o.isEmptyObject(d.doingFix)&&!d.delayedFixes.length}function s(e,s){e.find(".secupress-item-status .secupress-label").text(s)}function a(e){return 1!==SecuPressi18nScanner.step||(s(e,SecuPressi18nScanner.error),e.addClass("status-error")),!1}e=o("#secupress-tests").find(".secupress-item-all").length,d.total=e;var l=-1;function r(s,n,e,t){var r=parseInt(SecuPressi18nScanner.offset);if(-1===l&&(l=parseInt(-r)),l+=r,!s)return a(n),0;d.doingScan[s]||(d.doingScan[s]=1,n.addClass("scanning").removeClass("status-error"),setTimeout(function(){o.getJSON(e.replace("admin-post.php","admin-ajax.php")).done(function(e){o(".secupress-scanned-current").html(s.replace(/_/g," ")+"<br>"+o(".secupress-item-all").index(n))}).fail(function(){a(n)}).always(function(){delete d.doingScan[s],c()&&o("body").trigger("allScanDone.secupress",[{isBulk:t}])})},l))}function n(){var e=d.delayedFixes.shift();o(e).trigger("bulkfix.secupress")}function t(){var e,s=o(".secupress-sg-content .secupress-row-check").filter(":checked").siblings(".secupress-fixit");e=s,(s=o.isEmptyObject(d.doingFix)?(e.filter(".delayed-fix").each(function(){d.delayedFixes.push(this)}),e.not(".delayed-fix")):e).length?s.trigger("bulkfix.secupress"):n()}function h(e){var s;return(s=(e=e.addClass("status-error").find(".secupress-ic-fix-actions")).next(".secupress-response-notice")).length&&secupressNotices.remove(s),s=secupressNotices.create({type:"bad",message:SecuPressi18nScanner.error}),e.after(s),g(SecuPressi18nScanner.error),x(),!1}function f(r){var e,c=o("#secupress-mf-content-"+r),s=c.children("form.secupress-item-content").serializeArray();if(!s)return h(c);(e=c.removeClass("status-error").find(".secupress-response-notice")).length&&secupressNotices.remove(e),c.addClass("fixing").find(".secupress-button-manual-fixit .secupress-icon-check").addClass("secupress-icon-shield").removeClass("secupress-icon-check"),c.find("button .text").text(SecuPressi18nScanner.fixInProgress),o.post(ajaxurl,s,null,"json").done(function(e){var s,n,t;n=c,(p(s=e)?(t=n.children("form.secupress-item-content"),s.data.form_contents=s.data.form_contents||"",s.data.form_contents||t.find(".secupress-button-manual-fixit").remove(),t.children(".secupress-ic-desc").html(s.data.message),t.children(".secupress-ic-fix-actions").html(s.data.form_contents),1):h(n))?o("body").trigger("manualFixDone.secupress",[{test:r,data:e.data}]):h(c)}).fail(function(){h(c)})}o("body").on("scanDone.secupress",function(e,s){o("#"+s.test);d.delayedFixes.length&&n()}),o("body").on("allScanDone.secupress",function(e,s){var n=o(".secupress-button-scan").last();n.length&&S(n)?(n={action:"secupress-update-oneclick-scan-date",_wpnonce:n.data("nonce")},o.getJSON(ajaxurl,n).done(function(e){var s,n;o.isPlainObject(e)&&e.success&&e.data&&(s=e.data,(n=o("#secupress-latest").find(".secupress-reports-list")).children(".secupress-empty").remove(),5===n.children("li").length?n.children("li:last").slideUp(250,function(){o(this).remove(),n.prepend(s).find("li.hidden").slideDown(250)}):n.prepend(s).find("li.hidden").slideDown(250))}).always(function(){b(o(".secupress-button-scan")),y(s.isBulk,!0)})):y(s.isBulk)}),o("body").on("fixDone.secupress",function(e,s){var n=o("#"+s.test),t=n.data("scan-url");r(s.test,n,t,!0)}),o("body").on("allFixDone.secupress",function(e){}),o("body").on("manualFixDone.secupress",function(e,s){var n=o("#secupress-mf-content-"+s.test),t=n.data("scan-url");r(s.test,n,t,!1)}),o("body").on("bulkscan.secupress",".secupress-scanit",function(e){var s,n;e.preventDefault(),r(e=i(n=(s=o(this)).attr("href")),s.closest(".secupress-item-"+e),n,!0)}),o("body").on("click.secupress scan.secupress keyup",".secupress-button-manual-scanit",function(e){var s,n,t,r,c,a;return!("keyup"===e.type&&!secupressIsSpaceOrEnterKey(e))&&void(S(s=o(this))||(e.preventDefault(),t=i(n=s.attr("href")),e=o("#secupress-mf-content-"+t),v(s),c=e,a=n,(r=t)&&(c.addClass("scanning").find(".secupress-button-manual-scanit .secupress-icon-check").addClass("secupress-icon-shield").removeClass("secupress-icon-check"),o.getJSON(a.replace("admin-post.php","admin-ajax.php")).done(function(e){p(e)&&o("body").trigger("scanDone.secupress",[{test:r,href:a,isBulk:!1,data:e.data}])}).always(function(){c.removeClass("scanning"),o("body").trigger("allScanDone.secupress",[{isBulk:!1}])}))))}),o("body").on("click.secupress bulkscan.secupress keyup",".secupress-button-scan",function(e){var s,n,t,r,c,a,i;return!("keyup"===e.type&&!secupressIsSpaceOrEnterKey(e))&&(4===SecuPressi18nScanner.step?(u.location=SecuPressi18nScanner.firstScanURL,!1):void(S(s=o(this))||(e.preventDefault(),v(o(".secupress-button-scan")),o("#secupress-button-scan-speed").hide(),o(".secupress-scanit").trigger("bulkscan.secupress"),s=s,t=o(".secupress-introduce-first-scan"),r=o(".secupress-scanners-header"),c=s.closest(".secupress-not-scanned-yet").length,a=o(".secupress-progressbar-val"),i=o(".secupress-progress-val-txt"),r.addClass("secupress-scanning"),o(".secupress-scanned-total").text(d.total),n=setInterval(function(){var e=Object.keys(d.doingScan).length,e=d.total-e,e=Math.max(e/d.total*100,2),e=Math.round(Math.min(e,100));a.css("width",e+"%"),i.text(e+" %"),100<=e&&(g(SecuPressi18nScanner.a11y.scanEnded),clearInterval(n),c?t.slideUp(200,function(){o(".secupress-open-moreinfo").removeClass("secupress-activated"),o("#secupress-more-info").removeClass("secupress-open").hide(),o(".secupress-scan-header-main").css("display","flex").hide().slideDown(200,function(){o(".secupress-scanners-header.secupress-not-scanned-yet").removeClass("secupress-not-scanned-yet")}),m()}):r.removeClass("secupress-scanning"))},100))))}),o("body").on("bulkfix.secupress",".secupress-fixit",function(e){var s,n,t,r;e.preventDefault(),e=i(s=(t=o(this)).attr("href")),t=t.closest(".secupress-item-"+e),t=t,r=s,(n=e)&&(d.doingFix[n]||(e=t).hasClass("status-bad")&&!e.hasClass("not-fixable")&&(d.doingFix[n]=1,t.addClass("fixing").removeClass("status-error"),o.getJSON(r.replace("admin-post.php","admin-ajax.php")).done(function(e){delete d.doingFix[n],p(e)&&o("body").trigger("fixDone.secupress",[{test:n,href:r,data:e.data}])}).fail(function(){delete d.doingFix[n]}).always(function(){o.isEmptyObject(d.doingFix)&&!d.delayedFixes.length&&o("body").trigger("allFixDone.secupress")})))}),o("body").on("click.secupress bulkfix.secupress keyup",".secupress-button-autofix",function(e){var s;return!("keyup"===e.type&&!secupressIsSpaceOrEnterKey(e))&&void(S(o(this))||(e.preventDefault(),v(o(".secupress-button-autofix")),t(),s=o(".secupress-step-content-header, #secupress-tests, .secupress-step-content-footer"),e=o("#secupress-spinner"),s.spHide(),e.spFadeIn().removeClass("hidden"),g(SecuPressi18nScanner.a11y.bulkFixStart),setTimeout(w,18e4)))}),o("body").on("submit.secupress manualfix.secupress","form.secupress-item-content",function(e){var s=o(this),n=s.find(".secupress-button-manual-fixit");e.preventDefault(),S(n)||(v(o(".secupress-button-manual-fixit, .secupress-button-ignoreit")),f(s.parent(".secupress-mf-content").attr("id").replace("secupress-mf-content-","")))}),o("body").on("click.secupress next.secupress keyup",".secupress-button-ignoreit",function(e){var s,n;return!("keyup"===e.type&&!secupressIsSpaceOrEnterKey(e))&&(!S(n=o(this))&&((n=(s=o("."+n.attr("data-parent"))).next()).length?(e.preventDefault(),s.addClass("hide-if-js"),n.removeClass("hide-if-js"),n=o(".step3-advanced-text").first().text(),n=Number(n)+1,void o(".step3-advanced-text").text(n)):(u.location=this.href,!1)))}),o(".secupress-item-all.autoscan .secupress-scanit").trigger("bulkscan.secupress"),SecuPressi18nScanner.firstOneClickScan&&c()&&o(".secupress-button-scan").last().trigger("bulkscan.secupress")}(window,(document,r))});
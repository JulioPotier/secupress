
var $=jQuery;$(document).ready(function(){var opener=$('[data-plugin="secupress-pro/secupress-pro.php"] span.deactivate a');new ModalSecuPress($("#secupress-Modal"),opener);$('.secupress-Modal-footer .secupress-button').attr('href',$(opener).attr('href'));$('.secupress-button-send').hide();$('#secupress-send-reason').on('click',function(e){var params={action:'secupress_send_deactivation_info',reason:$('#secupress-reason').val()+' '+$('#secupress-details').val(),nonce:$('#secupress-Modal').data('nonce')};$.get(ajaxurl,params);});});function ModalSecuPress(aElem,opener){var refThis=this;this.elem=aElem;this.overlay=$('.secupress-Modal-overlay');this.radio=$('input[name=reason]',aElem);this.closer=$('.secupress-Modal-close, .secupress-Modal-cancel',aElem);this.return=$('.secupress-Modal-return',aElem);this.opener=opener;this.question=$('.secupress-Modal-question',aElem);this.button=$('.secupress-button-send',aElem);this.title=$('.secupress-Modal-header h2',aElem);this.textFields=$('input[type=text], textarea',aElem);this.hiddenReason=$('#secupress-reason',aElem);this.hiddenDetails=$('#secupress-details',aElem);this.titleText=this.title.html();this.opener.click(function(e){e.preventDefault();refThis.open();});this.closer.click(function(){refThis.close();});$('body').on('keyup',function(){if(27===event.keyCode){refThis.close();}});$('.secupress-Modal-overlay').on('click',function(){refThis.close();});this.return.click(function(){refThis.returnToQuestion();});this.radio.click(function(){refThis.change($(this));});this.textFields.keyup(function(){refThis.hiddenDetails.val($(this).val());if(refThis.hiddenDetails.val()!=''){refThis.button.removeClass('secupress-isDisabled');refThis.button.removeAttr("disabled");}
else{refThis.button.addClass('secupress-isDisabled');refThis.button.attr("disabled",true);}});}
ModalSecuPress.prototype.change=function(aElem){var id=aElem.attr('id');var refThis=this;this.hiddenReason.val(aElem.val());this.hiddenDetails.val('');this.textFields.val('');$('.secupress-Modal-fieldHidden').hide(200);$('.secupress-Modal-hidden').hide(200);$('.secupress-button-send').show();$('.secupress-button-skip').hide();switch(id){case'sp-reason-temporary':break;case'sp-reason-broke':case'sp-reason-score':case'sp-reason-hacked':case'sp-reason-complicated':var $panel=$('#'+id+'-panel');refThis.question.hide(200);refThis.return.show();$panel.show(200);var titleText=aElem.next('label').html();this.title.html(titleText);break;case'sp-reason-competitor':case'sp-reason-other':var field=aElem.siblings('.secupress-Modal-fieldHidden');field.show(200);field.find('input, textarea').focus().keyup();break;}};ModalSecuPress.prototype.returnToQuestion=function(){$('.secupress-Modal-fieldHidden').hide(200);$('.secupress-Modal-hidden').hide(200);this.question.show(200);this.return.hide();this.title.html(this.titleText);this.radio.prop('checked',false);this.hiddenReason.val('');this.hiddenDetails.val('');$('.secupress-button-send').hide();$('.secupress-button-skip').show();};ModalSecuPress.prototype.open=function(){var refThis=this;this.overlay.fadeIn(100,function(){refThis.elem.slideDown(300);});};ModalSecuPress.prototype.close=function(){var refThis=this;this.returnToQuestion();this.elem.slideUp(200,function(){refThis.overlay.fadeOut(80);});this.radio.prop('checked',false);};